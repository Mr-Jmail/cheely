<!DOCTYPE html>
<html>

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
    <link rel="shortcut icon" href="assets/images/icon-darkback-12801280-360x360.png" type="image/x-icon">

    <link rel="stylesheet" href="roulette2.css">


    <title>Cheelee Roulette</title>

</head>

<body>
    <section class="background">
        <div class="div_logo">
            <img class="image_logo" src="assets/images/icon-noBack-forDarkBack-1280х1280.png" alt="">
        </div>
        <p class="text-top">Смотри. Играй</p><strong>
            <nobr>
                <h1 class="rainbow">ЗАРАБАТЫВАЙ</h1>
            </nobr>
        </strong>


        <div id="animation">
            <div class="line" id="line" style="
    height: 354.188px;
    padding-top: 0px;
"></div>

            <div class="animation-block">
                <div class="raffle-roller-container" style="margin-left: 0px;">
                </div>
            </div>
        </div>

        <div id="post-btn" class="button-an">Определить
            победителя</div>
        <!-- <div class="line-canvas" id="line">
            <canvas id="canvas"></canvas>
        </div> -->
        <!-- <img class="image_3" src="assets/images/mn-1-360x360.png" alt=""> -->
        <img class="image_4" src="assets/images/-360x360.png" alt="">
        <p class="text-bottom">
            <strong>AVAILABLE ON<br>GOOGLE APP AND APP STORE</strong>
        </p>
    </section>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>

    <script defer>
        const HOST = "https://nodejs.helpervk.ru/";




        var items = [
            {
                tag: "TestTag",
                username: "TestNick1"
            },
            {
                tag: "TestTag",
                username: "TestNick"
            },
            {
                tag: "TestTag",
                username: "TestNick"
            },
        ];

        function generate(number) {
            $('.raffle-roller-container').css({
                transition: "sdf",
                "margin-left": "0px"
            }, 10).html('');
                for(var i = 0; i < 101; i++) {
                    var randed = randomInt(0,items.length);
                    var element = '<div class="item"> <h5 class="user-title" > ПОБЕДИТЕЛЬ КОНКУРСА</h5 > <p class="user-text"  id="CardNumber'+i+'">' + items[randed].username + '<br>' + items[randed].tag + '</p><div class="user-block-img"><img class="user-img" src="assets/images/mn-808x808.png" alt=""></div></div>';
                    $(element).appendTo('.raffle-roller-container');
                }
            setTimeout(function () {
                goRoll(number);
            }, 500);
        }

        function goRoll(number) {
            $('.raffle-roller-container').css({
                transition: "all 13s cubic-bezier(.08,.6,0,.85)"
            });
    document.getElementById('CardNumber78').innerHTML = items[number].username + '<br>' + items[number].tag;
            setTimeout(function () {
                $('#CardNumber26').addClass('winning-item');
            }, 8500);

            $('.raffle-roller-container').css('margin-left', '-6770px');
        }
        function randomInt(min, max) {
            return Math.floor(Math.random() * (max - min)) + min;
        }




        // let user_background = document.getElementsByClassName("user_background");


        // let user_backgroundRect = user_background[0].getBoundingClientRect();

        // let line = document.getElementsByClassName("line")[0];

        // line.style.height = user_backgroundRect.height + 'px';

        // var distance_el = 50;

        // var distance = user_backgroundRect.width + distance_el;

        // var speed = 15;

        // var width = $(window).width();

        // let users = Math.floor(width / distance);
        // console.log(users)

        // let left = width / users;

        // let center = Math.pow(users / 2) - 1;

        //console.log(center)

        const accessToken = localStorage.getItem("accessToken");

        document.getElementById("animation").style.display = "none";
                   //  document.getElementById("line").style.display = "none";

            document.getElementById("post-btn").style.display = "block";
        // if (accessToken) {
        //     document.getElementById("animation").style.display = "none";
        //     document.getElementById("post-btn").style.display = "block";
                //     document.getElementById("line").style.display = "none";
        // } else {
        //     document.getElementById("line").style.display = "none";
        //     document.getElementById("post-btn").style.display = "none";
        //     for (let i = 0; i < users; i++) {
        //         if (i == 0) {
        //             user_background[0].style.left = distance_el / 2 + 'px';
        //         } else {
        //             user_background[i].style.left = (i) * left + distance_el / 2 + 'px';
        //         }
        //         // else if (i==center) {
        //         //     user_background[0].style.left = (i)*left+distance_el/2+'px';
        //         // } 
        //     }
        // }

        


        const button = document.getElementById('post-btn');

        button.addEventListener('click', async _ => {

            document.getElementById("animation").style.display = "block";

            generate(0);

            console.log(111);

             document.getElementById("post-btn").style.display = "none";



            // let response = await fetch(HOST + 'getwinner', {
            //     method: 'POST',
            // });
            // if (response.ok) {
            //     let json = await response.json();
            //     console.log(json);
            // }

        });



    </script>


</body>

</html>